const productos = [

  {id: "iPhone-16-128GB",
  titulo: "iPhone 16 128GB",
  imagen: "assets/images/apple/iphone16normal.webp",
  categoria: {
    nombre: "iPhone 16",
    id: "apple"
  }
},
{
  id: "iPhone-16-Pro-128GB",
  titulo: "iPhone 16 Pro 128GB",
  imagen: "assets/images/apple/iphone16.webp",
  categoria: {
    nombre: "iPhone 16 Pro",
    id: "apple"
  }
},
{
  id: "iPhone-16-Pro-256GB",
  titulo: "iPhone 16 Pro 256GB",
  imagen: "assets/images/apple/iphone16pro.webp",
  categoria: {
    nombre: "iPhone 16 PRO 256GB",
    id: "apple"
  },
 
},
{
  id: "iPhone-16-Pro-512GB",
  titulo: "iPhone 16 Pro 512GB",
  imagen: "assets/images/apple/iphone16pro.webp",
  categoria: {
    nombre: "iPhone 16 pro 512Gb",
    id: "apple"
  }
},
    {
        id: "Samsung-GalaxyS23Ultra",
        titulo: "Galaxy S23 Ultra 5G",
        imagen: "./assets/images/samsung/samsungs23.jpg",
        categoria: {
          nombre: "Samsung-GalaxyS23Ultra",
          id: "Samsung"
        }
      },
      {
        id: "Samsung-GalaxyS24Ultra",
        titulo: "Galaxy S24 Ultra 5G",
        imagen: "assets/images/samsung/s24ultra.webp",
        categoria: {
          nombre: "Samsung-GalaxyS24Ultra",
          id: "Samsung"
        }
      },
      {
        id: "Samsung-GalaxyS24",
        titulo: "Galaxy S24 | S24+ 5G",
        imagen: "assets/images/samsung/s24normal.avif",
        categoria: {
          nombre: "Samsung-GalaxyS24",
          id: "Samsung"
        }
      },
      {
        id: "Samsung-GalaxyZFlip6",
        titulo: "Galaxy Z Flip6 5G",
        imagen: "assets/images/samsung/zflip6.jpg",
        categoria: {
          nombre: "Samsung-GalaxyZFlip6",
          id: "Samsung"
        }
      },
      {
        id: "Samsung-GalaxyA05s",
        titulo: "Galaxy A05s",
        imagen: "assets/images/samsung/a05.webp",
        categoria: {
          nombre: "Samsung-GalaxyA05s",
          id: "Samsung"
        }
      }, 
      {
        id: "Bose-S1PRO",
        titulo: "S1 PRO",
        imagen: "assets/images/bose/S1pro+.jpeg",
        categoria: {
          nombre: "Bose-S1PRO",
          id: "Bose"
        }
      },
      {
        id: "Bose-251ENVIROMENTAL",
        titulo: "251 ENVIROMENTAL SPEAKER",
        imagen: "assets/images/bose/251enviromental.webp",
        categoria: {
          nombre: "Bose-251ENVIROMENTAL",
          id: "Bose"
        }
      },
      {
        id: "Bose-BASSMODULE700",
        titulo: "BASS MODULE 700",
        imagen: "assets/images/bose/BOSE-BASS-MODULE-700.jpg",
        categoria: {
          nombre: "Bose-BASSMODULE700",
          id: "Bose"
        }
      },
      {
        id: "Bose-SMARTSOUNDBAR900",
        titulo: "SMART SOUNDBAR 900",
        imagen: "assets/images/bose/soundbar900.jpeg",
        categoria: {
          nombre: "Bose-SMARTSOUNDBAR900",
          id: "Bose"
        }
      },
      {
        id: "Bose-SMARTSOUNDBAR600",
        titulo: "SMART SOUNDBAR 600",
        imagen: "assets/images/bose/soundbar600.png",
        categoria: {
          nombre: "Bose-SMARTSOUNDBAR600",
          id: "Bose"
        }
      },
      {
        id: "Bose-SUB2",
        titulo: "SUB2 POWERED BASS MODULE",
        imagen: "assets/images/bose/sub2.jpg",
        categoria: {
          nombre: "Bose-SUB2",
          id: "Bose"
        }
      },
      {
        id: "Bose-SOUNDLINKFLEX",
        titulo: "SOUNDLINK FLEX",
        imagen: "/assets/images/bose/SOUNDLINKFLEX.jpeg",
        categoria: {
          nombre: "Bose-SOUNDLINKFLEX",
          id: "Bose"
        }
      },
      {
        id: "Bose-QUIETCOMFORTHEADPHONES",
        titulo: "QUIETCOMFORT HEADPHONES",
        imagen: "/assets/images/bose/bosequietcomfort.png",
        categoria: {
          nombre: "Bose-QUIETCOMFORTHEADPHONES",
          id: "Bose"
        }
      },
      {
        id: "Bose-ULTRAOPENEARBUDS",
        titulo: "ULTRA OPEN EARBUDS",
        imagen: "/assets/images/bose/openearbuds.png",
        categoria: {
          nombre: "Bose-ULTRAOPENEARBUDS",
          id: "Bose"
        }
      },
      {
        id: "Bose-NOISECANCELLING700",
        titulo: "NOISE CANCELLING 700",
        imagen: "/assets/images/bose/noisecancelling700.png",
        categoria: {
          nombre: "Bose-NOISECANCELLING700",
          id: "Bose"
        }
      },
      {
        id: " Refrigerador Samsung-RF32CG5N10B1",
        titulo: "French Door 892 L",
        imagen: "./assets/images/samsung/frenchdoor892.jpeg",
        categoria: {
          nombre: "Refrigerador Samsung-RF32CG5N10B1",
          id: "Samsung"
        }
      },
      {
        id: "Samsung-RS28CB760A7G",
        titulo: " Refrigerador Bespoke 793 L",
        imagen: "./assets/images/samsung/side by side793.jpeg",
        categoria: {
          nombre: "Samsung-RS28CB760A7G",
          id: "Samsung"
        }
      },
      {
        id: "Samsung-RS27T5200",
        titulo: "Refrigerador Side by Side 778 L",
        imagen: "./assets/images/samsung/nevecon778.webp",
        categoria: {
          nombre: "Samsung-RS27T5200",
          id: "Samsung"
        }
      },
      {
        id: "Samsung-RF29DB995012CO",
        titulo: "Refrigerador  RF29DB995012CO",
        imagen: "./assets/images/samsung/nevecon 809.webp",
        categoria: {
          nombre: "Samsung-RF29DB995012CO",
          id: "Samsung"
        }
      },  
      {
        id: "Samsung-RT53DG6790B1CO",
        titulo: "Congelador superior 520L / 382L / 345L / 412L / 522L",
        imagen: "./assets/images/samsung/congeladorsuperior.avif",
        categoria: {
          nombre: "Samsung-RT53DG6790B1CO",
          id: "Samsung"
        }
      }
  ];
  
  const contenedorProductos = document.querySelector ("#contenedor-productos");
  const botonesCategorias = document.querySelectorAll (".boton-categoria");
  const tituloPrincipal = document.querySelector("#titulo-principal");
  let botonAgregar = document.querySelector(".producto-agregar");
  const numero = document.querySelector("#numero");

  function cargarProductos(productosElegidos){

    contenedorProductos.innerHTML =""; 

    productosElegidos.forEach(producto => {
        const div = document.createElement("div");
        div.classList.add("producto");
        div.innerHTML =` <img class= "producto-imagen" src="${producto.imagen}" alt="${producto.titulo}">
                    <div class="producto-detalles">
                        <h3 class="producto-titulo">${producto.titulo}</h3>
                        
                        <button class="producto-agregar" id="${producto.id}">Agregar</button>
                    </div>
                    `;
        contenedorProductos.append(div);

    })
    actualizarBotonesAgregar();
  }

  cargarProductos(productos);

  botonesCategorias.forEach(boton => {
    boton.addEventListener("click", (e) =>{

      botonesCategorias.forEach(boton => boton.classList.remove("active"));
      e.currentTarget.classList.add("active");

      if(e.currentTarget.id != "todos"){
      const productoCategoria = productos.find(productos => productos.categoria.id === e.currentTarget.id);
      tituloPrincipal.innerText = productoCategoria.categoria.id;
      const productosBoton = productos.filter(productos => productos.categoria.id === e.currentTarget.id);
      cargarProductos(productosBoton);
      } else {
        tituloPrincipal.innerText = "Todos los productos";
        cargarProductos(productos);
      }
    })
  })
  
function actualizarBotonesAgregar (){
  botonAgregar = document.querySelectorAll(".producto-agregar");
  botonAgregar.forEach(boton => {
    boton.addEventListener("click", agregarAlCarrito);
  });
}

let productosEnCarrito;

let productosEnCarritoLS = localStorage.getItem("productos-en-carrito");


if(productosEnCarritoLS){
  productosEnCarrito = JSON.parse(productosEnCarritoLS);
  actualizarNumero();
} else {
  productosEnCarrito =[];
}


function agregarAlCarrito(e){

  const idBoton = e.currentTarget.id;
  const productoAgregado = productos.find(producto => producto.id ===  idBoton);

  if(productosEnCarrito.some(producto => producto.id === idBoton)){
    const index = productosEnCarrito.findIndex(producto => producto.id === idBoton)
    productosEnCarrito[index].cantidad++;
  }else{
    productoAgregado.cantidad = 1;
    productosEnCarrito.push(productoAgregado);
  }
  actualizarNumero();

  localStorage.setItem("productos-en-carrito", JSON.stringify(productosEnCarrito));
};

function actualizarNumero(){
  let nuevoNumero = productosEnCarrito.reduce((acc, producto) => acc + producto.cantidad, 0);
  numero.innerText = nuevoNumero;
}